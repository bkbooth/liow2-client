<div class="row" *ngIf="(state$ | async)?.user">
  <div class="col-sm-3 col-sm-push-9">
    <img [src]="(state$ | async)?.user?.picture" class="profile img-responsive img-circle">
  </div>
  <div class="col-sm-9 col-sm-pull-3">
    <table class="table table-bordered table-striped">
      <tbody>
      <tr>
        <th>Email</th>
        <td>{{ (state$ | async)?.user?.email }}</td>
      </tr>
      <tr>
        <th>Name</th>
        <td>
          <div *ngIf="!(state$ | async)?.isEditingName">
            <a (click)="setEditingName(true); $event.preventDefault()" class="pull-right" href>
              <i class="fa fa-fw fa-pencil"></i>
            </a>
            {{ (state$ | async)?.user?.name }}
          </div>
          <div *ngIf="(state$ | async)?.isEditingName">
            <a (click)="setEditingName(false); $event.preventDefault()" class="pull-right" href>
              <i class="fa fa-fw fa-times"></i>
            </a>

            <form
              (ngSubmit)="form.valid && saveUserName(firstName.value, lastName.value)"
              #form="ngForm"
              class="form-inline"
              novalidate
            >
              <div class="form-group" [class.has-error]="form.submitted && firstName.invalid">
                <label class="sr-only" for="firstName">First name</label>
                <input
                  type="text"
                  class="form-control"
                  id="firstName"
                  name="firstName"
                  #firstName="ngModel"
                  [ngModel]="(state$ | async)?.firstName"
                  (ngModelChange)="onUpdatePropertyAction('FirstName', $event)"
                  placeholder="First..."
                  required
                >
              </div>
              <div class="form-group">
                <label class="sr-only" for="lastName">Last name</label>
                <input
                  type="text"
                  class="form-control"
                  id="lastName"
                  name="lastName"
                  #lastName="ngModel"
                  [ngModel]="(state$ | async)?.lastName"
                  (ngModelChange)="onUpdatePropertyAction('LastName', $event)"
                  placeholder="Last..."
                >
              </div>
              <button type="submit" class="btn btn-success">
                <i class="fa fa-check"></i>
              </button>
            </form>
          </div>
        </td>
      </tr>
      <tr>
        <th>Password</th>
        <td>
          <a (click)="openChangePassword(); $event.preventDefault()" href>
            Change password
          </a>
          <a (click)="openChangePassword(); $event.preventDefault()" class="pull-right" href>
            <i class="fa fa-fw fa-pencil"></i>
          </a>
        </td>
      </tr>
      <tr>
        <th>Joined</th>
        <td>{{ (state$ | async)?.user?.created | moment:'LL' }}</td>
      </tr>
      <tr>
        <th>Acts of Love</th>
        <td>{{ (userCounter$ | async) | number }}</td>
      </tr>
      <tr>
        <th>Confirmed</th>
        <td>
          <ui-icon-checked [isChecked]="(state$ | async)?.user?.confirmed"></ui-icon-checked>
          <span *ngIf="!(state$ | async)?.user?.confirmed" class="m-l-xs">
            <a (click)="sendConfirmEmail(); $event.preventDefault()" href>
              Re-send confirmation email?
              <i class="fa fa-cog fa-spin" [hidden]="!(state$ | async)?.isSendingConfirmEmail"></i>
            </a>
          </span>
        </td>
      </tr>
      <tr *ngIf="(state$ | async)?.user?.superAdmin">
        <th>Super Admin</th>
        <td>
          <ui-icon-checked [isChecked]="true"></ui-icon-checked>
        </td>
      </tr>
      </tbody>
    </table>
  </div>
</div>
